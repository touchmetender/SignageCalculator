<!DOCTYPE html>
<html>
<head>
  <title>Signage Calculator - Material Database</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="firebase-config.js"></script>
  <style>
    body { font-family: Arial; margin: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; }
    th { background-color: #eee; }
    #logout { float: right; margin-top: -30px; }
  </style>
</head>
<body>
  <h2>Material Database <a href="calculation.html">Go to Calculation</a></h2>
  <div id="user-info"></div>
  <button id="logout">Logout</button>
  <table id="materialTable">
    <thead>
      <tr><th>Code</th><th>Name</th><th>Price</th><th>Unit</th><th>Price/Unit</th><th>Measure Unit</th></tr>
    </thead>
    <tbody></tbody>
  </table>

<script>
firebase.auth().onAuthStateChanged(user => {
  if (!user) location.href = "login.html";
  else {
    document.getElementById("user-info").innerText = "Logged in as: " + user.email;
  }
});

document.getElementById("logout").onclick = () => firebase.auth().signOut();

firebase.database().ref("materials").once("value").then(snapshot => {
  const tbody = document.querySelector("#materialTable tbody");
  const data = snapshot.val();
  for (let id in data) {
    const row = data[id];
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${row.code}</td><td>${row.name}</td><td>${row.price}</td><td>${row.unit}</td><td>${row.pricePerUnit}</td><td>${row.measureUnit}</td>`;
    tbody.appendChild(tr);
  }
});
</script>
</body>
</html>